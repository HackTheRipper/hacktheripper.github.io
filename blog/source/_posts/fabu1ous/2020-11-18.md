---

title: "[하루한줄] CVE-2020–15647 website stealing files from device"

author: Fabu1ous

tags: [Fabu1ous, ]

categories: [1day1line]

date: 2020-11-18 18:00:00

cc: true

index_img: /img/1day1line.png
---



## URL

[Firefox: How a website could steal all your cookies](https://medium.com/@kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d)



## Target

Firefox Fennec v68.9.0



## Explain

해커의 웹싸이트에 접속하는 것만으로 안드로이드 디바이스의 로컬 파일이 탈취당할수 있습니다. 안드로이드용 `Firefox Content Provider`를 악용하는 취약점으로, Firefox에게 접근권한이 있는 모든 파일들을 웹페이지가 읽을수 있습니다. 이런 행위가 가능한 이유는 아래와 같습니다.

1. `content://` URI가 파일을 cache할 때 이름을 바꾸지 않습니다.
2. [file content provider](https://developer.android.com/training/secure-file-sharing/setup-sharing)의 공유가능 디렉토리가 root-path로 설정돼있습니다.
3. 파일은 자기자신에게 접근할수있습니다.

victim으로 부터 탈취하고자 하는 파일( `file_1`)과 동일한 이름의 악성 파일( `file_2` )을 victim에 설치합니다. `file_2`를 `content://` URI로 열면 `file_3`로 cache된뒤 redirect됩니다.  그후 `file_1`를  `content://` URI로 열면 기존에 cache된 profile.ini를 overwrite하게 됩니다.



`file_1` = root/data/user/0/org.mozilla.firefox/files/mozilla/profile.ini

`file_2` = root/sdcard/Download/profile.ini

`file_3` = data/data/org.mozilla/firefox/cache/contentUri/profile.ini

## Reference 

