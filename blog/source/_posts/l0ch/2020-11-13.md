---
title: "[하루한줄] Persistent arbitrary code execution in Android's Google Play Core Library"
author: L0ch
tags: [L0ch, arbitrary code execution, google, play core library, path traversal, android, cve-2020-8913]
categories: [1day1line]
date: 2020-11-13 18:00:00
cc: true
index_img: /img/1day1line.png
---

## URL 

[CVE-2020-8913 - Persistent arbitrary code execution in Android's Google Play Core Library](https://hackerone.com/reports/971386)



## Target

Android Play Core ≤ 1.7.2

## Explain

Google API를 통해 사용자가 Play Store에 접근하지 않고 인앱 업데이트를 할 수 있게 해주는 Play Core Library에서 임의 코드 실행이 가능한 취약점이 발견되었습니다.

이 취약점을 악용하면 Play Core Library를 사용하는 모든 안드로이드 앱을 대상으로 임의 코드 실행이 가능합니다.

취약성이 존재하는 부분은 `SplitCompat.install` 로, 동일한 기기에 설치된 타사 앱이 임의의 데이터를 broadcast 하도록 허용합니다. 이 때 `split_id` 에 대한 유효성 검사가 없어 path traversal이 가능하며 앱의 런타임 ClassLoader에 임의 코드를 포함하는 클래스를 생성하고 해당 인스턴스에 영향을 받는 앱에서 실행할 수 있습니다.

공격자는 Play Core Library를 사용하는 앱을 타겟으로 하는 악성 APK를 제작하고, 피해자가 이를 설치하도록 유도하면 타겟 앱의 데이터에 액세스 및 코드 실행이 가능합니다.

이 취약점은 Google Chrome 을 비롯한 인기 앱에서 임의 코드 실행이 가능하다는 점에서 심각한 취약점으로 분류되었습니다.